(()=>{var e={"./src/background/events/handleConfigurationRequest.js":(e,s,t)=>{"use strict";const r=t("./src/config.js"),n=t("./src/installPage/functions/configurationComplete.js"),o=t("./src/notification/index.js"),{loadFromLocalStorage:a,saveToLocalStorage:i}=t("./src/localStorage/index.js"),c=t("./src/partials/storeLog.js");e.exports=(e,s)=>a(["configured","devices"]).then((e=>e.configured?e:i({configured:!0},e))).then((e=>{let t=[],r=!1;const{device_id:n,device_public_key:o}=s;return e.devices&&(t=e.devices),t.map((e=>(e.device_id===n&&(r=!0),e))),r?e:(t.push({device_id:n,device_public_key:o}),i({devices:t},e))})).then(n).catch((async s=>(await c("error",7,s,"configurationRequest"),o.show(r.Texts.Error.UndefinedError,e))))},"./src/background/events/handleLoginRequest.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),n=t("./src/config.js"),o=t("./src/background/functions/closeRequest.js"),a=t("./src/notification/index.js"),i=t("./src/background/functions/Crypt.js"),c=t("./src/localStorage/loadFromLocalStorage.js"),l=t("./src/partials/storeLog.js"),g=t("./src/partials/sendMessageToTab.js");e.exports=(e,s)=>{const t=new i;return r.tabs.get(e).then((()=>c(["keys"]))).then((e=>{const s=t.stringToArrayBuffer(e.keys.privateKey);return t.importKey(s,"pkcs8",["decrypt"])})).then((e=>t.decrypt(e,t.stringToArrayBuffer(s.token)))).then((e=>t.decodeText(e))).then((t=>{const r=s;return r.token=t,g(e,{action:"inputToken",...r})})).then((()=>o(e,s.token_request_id))).catch((async t=>t.toString().includes("No tab with id")||t.toString().includes("Invalid tab ID")?o(e,s.token_request_id).then((()=>a.show(n.Texts.Error.LackOfTab,e))):(await l("error",8,t,"handleLoginRequest"),a.show(n.Texts.Error.UndefinedError,e))))}},"./src/background/events/index.js":(e,s,t)=>{"use strict";s.handleConfigurationRequest=t("./src/background/events/handleConfigurationRequest.js"),s.handleLoginRequest=t("./src/background/events/handleLoginRequest.js")},"./src/background/functions/Crypt.js":(e,s,t)=>{"use strict";const r=t("./src/background/functions/ab2b64.js"),n=t("./src/background/functions/b642ab.js");e.exports=class{constructor(){this.encoder=new TextEncoder,this.decoder=new TextDecoder("utf-8")}generateKeys(){return crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-512"}},!0,["encrypt","decrypt"])}importKey(e,s,t){return crypto.subtle.importKey(s,e,{name:"RSA-OAEP",hash:{name:"SHA-512"}},!1,t)}exportKey(e,s){return crypto.subtle.exportKey(e,s)}ArrayBufferToString(e){const s=new Uint8Array(e);return r(s)}stringToArrayBuffer(e){return n(e)}encodeText(e){return this.encoder.encode(e)}decodeText(e){const s=new DataView(e);return this.decoder.decode(s)}encrypt(e,s){return crypto.subtle.encrypt({name:"RSA-OAEP"},e,s)}decrypt(e,s){return crypto.subtle.decrypt({name:"RSA-OAEP"},e,s)}}},"./src/background/functions/ab2b64.js":e=>{"use strict";e.exports=e=>btoa(String.fromCharCode.apply(null,new Uint8Array(e)))},"./src/background/functions/b642ab.js":e=>{"use strict";e.exports=e=>Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))},"./src/background/functions/browserAction.js":(e,s,t)=>{"use strict";const r=t("./src/config.js"),n=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),o=t("./src/localStorage/loadFromLocalStorage.js"),a=t("./src/background/functions/openInstallPage.js"),i=t("./src/background/functions/browserActionConfigured.js"),c=t("./src/partials/storeLog.js"),l=t("./src/notification/index.js");e.exports=e=>e&&e?.url?o(null).then((s=>{if(!s.configured){const s=n.runtime.getURL("/installPage/installPage.html");return e.url===s?(console.warn(r.Texts.Error.ConfigFirst.Message),l.show(r.Texts.Error.ConfigFirst,e?.id)):a()}return i(e,s)})).catch((s=>c("error",4,s,e?.url||"browserAction"))):(console.warn(r.Texts.Info.BrowserActionWithoutTab.Message),l.show(r.Texts.Info.BrowserActionWithoutTab,e?.id))},"./src/background/functions/browserActionConfigured.js":(e,s,t)=>{"use strict";const r=t("./src/config.js"),n=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),o=t("./src/notification/index.js"),a=t("./src/background/functions/initBEAction.js"),i=t("./src/localStorage/saveToLocalStorage.js"),c=t("./src/background/functions/sendNotificationInfo.js"),l=t("./src/background/functions/checkIconTitleText.js");e.exports=async(e,s)=>{const t=new URL(e?.url),g=(new Date).getTime();let u,d,m=s;return m.globalLastAction?(u=(g-m.globalLastAction)/1e3,d=1<Math.round(u)):d=!0,m=await i({globalLastAction:g},m),!!d&&(d=await l(e?.id),!!d)&&("https:"!==t.protocol&&"http:"!==t.protocol&&(console.warn(`${t.protocol} ${n.i18n.getMessage("isNotSupportedByExt")}`),o.show(r.Texts.Info.UnsupportedProtocol,e?.id),d=!1),!!d&&("notifications"in m&&m.notifications||c(e),a(t.origin,e,m)))}},"./src/background/functions/checkIconTitleText.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),n=t("./src/notification/functions/showNativePush.js"),o=t("./src/config.js");e.exports=async e=>{if(!e||0>parseInt(e,10))return!0;let s;return s=await r.action.getTitle({tabId:e}),s!==r.i18n.getMessage("inActiveTabInfo")||(n(o.Texts.Error.InactiveTab,!0),!1)}},"./src/background/functions/checkSafariStorage.js":(e,s,t)=>{"use strict";const r=t("./src/localStorage/loadFromLocalStorage.js"),n=t("./src/background/functions/generateDefaultStorage.js"),o=t("./src/background/functions/openInstallPage.js"),a=t("./src/partials/storeLog.js");e.exports=e=>r(null).then((s=>!(s.browserInfo&&s.keys&&s?.keys?.publicKey&&s?.keys?.privateKey&&s?.extensionID)&&n(e).then((()=>o())).catch((e=>a("error",9,e,"onInstalled"))))).catch((e=>a("error",35,e,"checkSafariStorage")))},"./src/background/functions/checkTabCS.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),n=t("./src/background/functions/setIcon.js"),o=t("./src/background/functions/dummyGetLocalStorage.js");e.exports=async e=>{let s;if(await new Promise((e=>setTimeout(e,100))),await o(),!e)return;try{s=await r.tabs.get(e)}catch(e){return}const t=s.url?s.url:s.pendingUrl,a=r.runtime.getURL("");let i;if(t.includes(a))await n(e,!1,!1);else{try{i=new URL(t)}catch(s){return void await n(e,!1,!1)}if("http:"===i.protocol||"https:"===i.protocol)try{await r.tabs.sendMessage(e,{action:"contentScript"}),await n(e)}catch(s){await n(e,!1,!0)}else await n(e,!1,!1)}}},"./src/background/functions/closeRequest.js":(e,s,t)=>{"use strict";const r=t("./src/sdk/index.js"),{loadFromLocalStorage:n,saveToLocalStorage:o}=t("./src/localStorage/index.js"),a=t("./src/partials/storeLog.js");e.exports=async(e,s)=>{let t;try{t=await n([`tabData-${e}`,"extensionID"])}catch(e){return a("error",30,e)}return!(!t||!t[`tabData-${e}`]?.requestID||s!==t[`tabData-${e}`]?.requestID)&&(new r).close2FARequest(t.extensionID,t[`tabData-${e}`].requestID,!0).then((()=>{const s=structuredClone(t[`tabData-${e}`]);return delete s.requestID,o({[`tabData-${e}`]:s})})).then((()=>{t=null})).catch((s=>a("error",30,s,t[`tabData-${e}`]?.url)))}},"./src/background/functions/closeWSChannel.js":e=>{"use strict";e.exports=e=>{1===e.readyState&&e.close()}},"./src/background/functions/createContextMenus.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),{loadFromLocalStorage:n,saveToLocalStorage:o}=t("./src/localStorage/index.js");e.exports=()=>n(["contextMenu"]).then((e=>"contextMenu"in e?e:o({contextMenu:!0},e))).then((e=>{if(e.contextMenu){const e={title:r.i18n.getMessage("shortcutDesc"),id:"twofas-context-menu",contexts:["page","editable"],enabled:!0,type:"normal",visible:!0};r.contextMenus.create(e)}})).catch((()=>{}))},"./src/background/functions/dummyGetLocalStorage.js":(e,s,t)=>{"use strict";const r=t("./src/localStorage/loadFromLocalStorage.js");e.exports=()=>r("extensionID").then((()=>{}))},"./src/background/functions/generateDefaultStorage.js":(e,s,t)=>{"use strict";const r=t("./src/config.js"),n=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),{clearLocalStorage:o,saveToLocalStorage:a}=t("./src/localStorage/index.js"),i=t("./src/sdk/index.js"),c=t("./src/background/functions/Crypt.js"),l=t("./src/partials/storeLog.js");e.exports=e=>{const s=new c;return o().then((()=>s.generateKeys())).then((e=>Promise.all([s.exportKey("spki",e.publicKey),s.exportKey("pkcs8",e.privateKey)]))).then((t=>{const n={publicKey:s.ArrayBufferToString(t[0]),privateKey:s.ArrayBufferToString(t[1])};return a({configured:!1,browserInfo:e,keys:n,contextMenu:!0,logging:!1,notifications:!1,incognito:!1,nativePush:!0,pinInfo:!1,extensionVersion:r.ExtensionVersion})})).then((s=>{const t=structuredClone(e);return t.public_key=s.keys.publicKey,(new i).createExtensionInstance(t)})).then((e=>a({extensionID:e.id}))).then((e=>n.runtime.setUninstallURL(`https://2fas.com/byebye/${e.extensionID}/`))).catch((e=>l("error",28,e,"generateDefaultStorage")))}},"./src/background/functions/getBrowserInfo.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),n=t("./src/background/functions/getOSName.js");e.exports=()=>{let e=r.i18n.getMessage("unknown");try{e=navigator.userAgentData.brands.filter((e=>!e?.brand?.includes("Brand")&&!e?.brand?.includes("Chromium")))[0]?.version}catch(s){const t=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9.]+)/);e=null==t||2!==t.length?r.i18n.getMessage("unknown"):t[1]}{const s=navigator?.userAgentData?.brands?0<navigator.userAgentData.brands.filter((e=>e?.brand?.includes("Brave"))).length:void 0!==navigator.brave&&"isBrave"===navigator.brave.isBrave.name;return{name:`${s?"Brave":"Chrome"} ${r.i18n.getMessage("browserOnOs")} ${n()}`,browser_name:s?"Brave":"Chrome",browser_version:e}}}},"./src/background/functions/getOSName.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js");e.exports=()=>{let e=r.i18n.getMessage("unknownOS");return navigator.userAgentData?e=navigator.userAgentData.platform:(-1!==navigator.userAgent.indexOf("Windows")&&(e="Windows"),-1!==navigator.userAgent.indexOf("Mac")&&(e="macOS"),-1!==navigator.userAgent.indexOf("X11")&&(e="UNIX"),-1!==navigator.userAgent.indexOf("Linux")&&(e="Linux")),e}},"./src/background/functions/index.js":(e,s,t)=>{"use strict";s.ab2b64=t("./src/background/functions/ab2b64.js"),s.b642ab=t("./src/background/functions/b642ab.js"),s.browserAction=t("./src/background/functions/browserAction.js"),s.browserActionConfigured=t("./src/background/functions/browserActionConfigured.js"),s.checkIconTitleText=t("./src/background/functions/checkIconTitleText.js"),s.checkSafariStorage=t("./src/background/functions/checkSafariStorage.js"),s.checkTabCS=t("./src/background/functions/checkTabCS.js"),s.closeRequest=t("./src/background/functions/closeRequest.js"),s.closeWSChannel=t("./src/background/functions/closeWSChannel.js"),s.createContextMenus=t("./src/background/functions/createContextMenus.js"),s.Crypt=t("./src/background/functions/Crypt.js"),s.dummyGetLocalStorage=t("./src/background/functions/dummyGetLocalStorage.js"),s.generateDefaultStorage=t("./src/background/functions/generateDefaultStorage.js"),s.getBrowserInfo=t("./src/background/functions/getBrowserInfo.js"),s.getOSName=t("./src/background/functions/getOSName.js"),s.initBEAction=t("./src/background/functions/initBEAction.js"),s.onCommand=t("./src/background/functions/onCommand.js"),s.onConnect=t("./src/background/functions/onConnect.js"),s.onContextMenuClick=t("./src/background/functions/onContextMenuClick.js"),s.onInstalled=t("./src/background/functions/onInstalled.js"),s.onMessage=t("./src/background/functions/onMessage.js"),s.onStartup=t("./src/background/functions/onStartup.js"),s.openBrowserPage=t("./src/background/functions/openBrowserPage.js"),s.openInstallPage=t("./src/background/functions/openInstallPage.js"),s.sendNotificationInfo=t("./src/background/functions/sendNotificationInfo.js"),s.setIcon=t("./src/background/functions/setIcon.js"),s.subscribeChannel=t("./src/background/functions/subscribeChannel.js"),s.updateBrowserInfo=t("./src/background/functions/updateBrowserInfo.js"),s.wsTabChanged=t("./src/background/functions/wsTabChanged.js")},"./src/background/functions/initBEAction.js":(e,s,t)=>{"use strict";const r=t("./src/config.js"),n=t("./src/localStorage/saveToLocalStorage.js"),o=t("./src/background/functions/subscribeChannel.js"),a=t("./src/notification/index.js"),i=t("./src/sdk/index.js"),c=t("./src/partials/storeLog.js");e.exports=(e,s,t)=>{const l=(new Date).getTime();let g,u=t,d=!1;u[`tabData-${s?.id}`]||(u[`tabData-${s.id}`]={});const m=u[`tabData-${s.id}`];return u[`tabData-${s?.id}`]?.lastFocusedInput?(u[`tabData-${s?.id}`]?.lastAction?(g=(l-u[`tabData-${s.id}`].lastAction)/1e3,d=Math.round(g)>=r.ResendPushTimeout):d=!0,d?(m.lastAction=l,n({[`tabData-${s?.id}`]:m},u).then((()=>(new i).request2FAToken(u.extensionID,e))).then((e=>(m.requestID=e.token_request_id,n({[`tabData-${s?.id}`]:m},u)))).then((t=>(u=t,o(u,s?.id,{action:!0,timeout:!0,login:!0,requestID:u[`tabData-${s?.id}`].requestID,notifications:{timeout:r.Texts.Error.PushExpired(e),error:r.Texts.Error.General}})))).then((e=>e.connect())).then((()=>a.show(r.Texts.Success.PushSent,s?.id))).catch((async e=>(await c("error",5,e,m?.url),a.show(r.Texts.Error.UndefinedError,s?.id))))):1<g?a.show(r.Texts.Warning.TooSoon(g),s?.id):void 0):a.show(r.Texts.Warning.SelectInput,s?.id)}},"./src/background/functions/onCommand.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),n=t("./src/background/functions/browserAction.js");e.exports=e=>"tokenRequest"===e&&r.tabs.query({active:!0,currentWindow:!0}).then((e=>n(e[0])))},"./src/background/functions/onConnect.js":(e,s,t)=>{"use strict";const r=t("./src/background/functions/openBrowserPage.js");e.exports=e=>{if("2FAS"!==e.name)return!1;const s=e=>{e.onMessage.removeListener(t),e.onDisconnect.removeListener(s),e._timer&&clearTimeout(e._timer),e=void 0},t=(e,s)=>"openBrowserPage"===e.action&&e.url?r(e.url):setTimeout((()=>{try{return s.postMessage({msg:"pong"})}catch(e){}}),1e4);e.onMessage.addListener(t),e.onDisconnect.addListener(s),e._timer=setTimeout((e=>{e.onDisconnect.removeListener(s),e.onMessage.removeListener(t),e._timer&&clearTimeout(e._timer),e.disconnect(),e=void 0}),25e4,e)}},"./src/background/functions/onContextMenuClick.js":(e,s,t)=>{"use strict";const r=t("./src/background/functions/browserAction.js");e.exports=(e,s)=>{if("twofas-context-menu"===e?.menuItemId)return r(s)}},"./src/background/functions/onInstalled.js":(e,s,t)=>{"use strict";const r=t("./src/background/functions/openInstallPage.js"),n=t("./src/partials/storeLog.js"),o=t("./src/background/functions/updateBrowserInfo.js"),a=t("./src/background/functions/createContextMenus.js"),i=t("./src/background/functions/generateDefaultStorage.js");t("./src/background/functions/checkSafariStorage.js");e.exports=(e,s)=>(a(),"install"===e?.reason?i(s).then((()=>r())).catch((e=>n("error",9,e,"onInstalled"))):o(s))},"./src/background/functions/onMessage.js":(e,s,t)=>{"use strict";const r=t("./src/background/functions/getBrowserInfo.js"),n=t("./src/background/functions/generateDefaultStorage.js"),o=t("./src/partials/storeLog.js");e.exports=(e,s)=>new Promise((t=>{switch(e.action){case"getTabData":{if(!s?.tab?.id)return t({status:"No tabID"});const e=s?.tab?.url||s.url;let r=new URL(e);return r=`${r.protocol}//${r.host}${r.pathname}`,t({id:s?.tab?.id,url:s?.tab?.url,urlPath:r})}case"storageReset":{const e=r();return n(e).then((()=>t(!0))).catch((async e=>await o("error",37,e,"storageReset")))}default:return t({status:"Empty action"})}}))},"./src/background/functions/onStartup.js":(e,s,t)=>{"use strict";const{loadFromLocalStorage:r,removeFromLocalStorage:n}=t("./src/localStorage/index.js"),o=t("./src/partials/storeLog.js");e.exports=()=>r(null).then((e=>Object.keys(e).map((s=>{if("tabData"===s||"tabData-"===s.substring(0,8)){return 15<parseInt(Math.abs(new Date(e[s].timestamp).getTime()-(new Date).getTime())/6e4%60)?n(s):null}return null})))).catch((e=>o("error",1,e,"onStartup")))},"./src/background/functions/openBrowserPage.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js");e.exports=e=>r.tabs.create({url:e})},"./src/background/functions/openInstallPage.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js");e.exports=()=>r.tabs.create({url:"installPage/installPage.html"})},"./src/background/functions/sendNotificationInfo.js":(e,s,t)=>{"use strict";const r=t("./src/config.js"),n=t("./src/partials/storeLog.js"),o=t("./src/localStorage/loadFromLocalStorage.js"),a=t("./src/notification/index.js"),i=t("./src/partials/sendMessageToTab.js");e.exports=e=>o(["nativePush"]).then((s=>s.nativePush?i(e?.id,{action:"notificationInfo"}):Promise.resolve())).catch((async s=>(await n("error",10,s,e?.url),a.show(r.Texts.Error.UndefinedError,e?.id))))},"./src/background/functions/setIcon.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js");e.exports=async function(e){let s=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],t=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];const n=s?{path:{16:r.runtime.getURL("images/icons/icon16.png"),32:r.runtime.getURL("images/icons/icon32.png"),48:r.runtime.getURL("images/icons/icon48.png"),96:r.runtime.getURL("images/icons/icon96.png"),128:r.runtime.getURL("images/icons/icon128.png")},tabId:e}:{path:{16:r.runtime.getURL("images/icons/icon16gray.png"),32:r.runtime.getURL("images/icons/icon32gray.png"),48:r.runtime.getURL("images/icons/icon48gray.png"),96:r.runtime.getURL("images/icons/icon96gray.png"),128:r.runtime.getURL("images/icons/icon128gray.png")},tabId:e},o=s?"2FAS - Two Factor Authentication":r.i18n.getMessage("inActiveTabInfo");r.action.setIcon(n),(s||!s&&t)&&await r.action.setTitle({tabId:e,title:o})}},"./src/background/functions/subscribeChannel.js":(e,s,t)=>{"use strict";const r=t("./src/config.js"),n=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),{handleConfigurationRequest:o,handleLoginRequest:a}=t("./src/background/events/index.js"),i=t("./src/notification/index.js"),c=t("./src/background/functions/closeRequest.js"),l=t("./src/background/functions/closeWSChannel.js"),g=t("./src/background/functions/wsTabChanged.js"),u=t("./src/partials/storeLog.js");e.exports=function(e,s){let t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{action:!0,timeout:!0,login:!0,requestID:null,notifications:{timeout:r.Texts.Error.Timeout,error:r.Texts.Error.General}};return new Promise(((d,m)=>{let f;const p={},b=(e,t)=>g(e,t,s,p,f);return p.connect=()=>(p.ws={},p.ws=t.login?new WebSocket(`wss://ws.2fas.com/browser_extensions/${e.extensionID}/2fa_requests/${t.requestID}`):new WebSocket(`wss://ws.2fas.com/browser_extensions/${e.extensionID}`),p.ws.onopen=()=>(f=setTimeout((()=>(l(p),console.warn("WebSocket Timeout"),t.timeout?i.show(t.notifications.timeout,s):i.showWithoutTimeout(t.notifications.timeout,s),t.login&&c(s,t.requestID),m(new Error("timeout")))),6e4*r.WebSocketTimeout-100),n.tabs.onRemoved.addListener(b),n.tabs.onUpdated.addListener(b),!0),p.ws.onerror=async e=>(n.tabs.onRemoved.removeListener(b),n.tabs.onUpdated.removeListener(b),clearTimeout(f),await u("error",11,e,"WebSocket channel error"),m(e)),p.ws.onclose=()=>{n.tabs.onRemoved.removeListener(b),n.tabs.onUpdated.removeListener(b),clearTimeout(f)},p.ws.onmessage=async e=>{const t=JSON.parse(e.data);switch(t.event){case"browser_extensions.pairing.success":return o(s,t),l(p),n.tabs.onRemoved.removeListener(b),n.tabs.onUpdated.removeListener(b),clearTimeout(f),!0;case"browser_extensions.device.2fa_response":return a(s,t),l(p),n.tabs.onRemoved.removeListener(b),n.tabs.onUpdated.removeListener(b),clearTimeout(f),!0;case"browser_extensions.pairing.failure":return await u("error",12,t,"browser_extensions.pairing.failure"),i.show(r.Texts.Error.WebSocket,s),l(p),n.tabs.onRemoved.removeListener(b),n.tabs.onUpdated.removeListener(b),clearTimeout(f),!0;default:throw await u("error",13,t,"subscribeChannel event default"),new Error("Unknown message")}},p),d(p)}))}},"./src/background/functions/updateBrowserInfo.js":(e,s,t)=>{"use strict";const r=t("./src/partials/storeLog.js"),{updateBrowserExtension:n,updateIncognitoAccess:o,verifyStorageIntegrity:a}=t("./src/background/functions/update/index.js");e.exports=e=>a(e).then((()=>n(e))).then(o).catch((e=>r("error",6,e,"updateBrowserInfo")))},"./src/background/functions/update/index.js":(e,s,t)=>{"use strict";s.updateBrowserExtension=t("./src/background/functions/update/updateBrowserExtension.js"),s.updateIncognitoAccess=t("./src/background/functions/update/updateIncognitoAccess.js"),s.verifyStorageIntegrity=t("./src/background/functions/update/verifyStorageIntegrity.js")},"./src/background/functions/update/updateBrowserExtension.js":(e,s,t)=>{"use strict";const r=t("./src/config.js"),{loadFromLocalStorage:n,saveToLocalStorage:o}=t("./src/localStorage/index.js"),a=t("./src/sdk/index.js"),i=t("./src/partials/storeLog.js");e.exports=async e=>{let s;try{s=await n(["extensionID","extensionVersion","browserInfo"])}catch(e){return i("error",27,e,"updateBrowserExtension - storage load")}if(s?.extensionVersion!==r.ExtensionVersion||!s?.browserInfo||s?.browserInfo?.browser_version!==e.browser_version||s?.browserInfo?.name!==e.name){let t=e;return t.name=s?.browserInfo?.name||t.name,(new a).updateBrowserExtension(s.extensionID,t).then((()=>o({browserInfo:t,extensionVersion:r.ExtensionVersion}))).then((()=>{s=null,t=null})).catch((e=>i("error",27,e,"updateBrowserExtension - API call")))}s=null}},"./src/background/functions/update/updateIncognitoAccess.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),{loadFromLocalStorage:n,saveToLocalStorage:o}=t("./src/localStorage/index.js"),a=t("./src/partials/storeLog.js"),i=t("./src/background/functions/checkTabCS.js");e.exports=async()=>{let e=null,s=await r.extension.isAllowedIncognitoAccess();try{e=await n(["incognito"])}catch(e){return a("error",26,e,"updateIncognitoAccess")}if(e.incognito!==s)return o({incognito:s},e).then((()=>{e=null,s=null})).then((()=>r.tabs.query({active:!0}))).then((e=>e.map((e=>i(e.id))))).catch((e=>a("error",26,e,"updateIncognitoAccess")))}},"./src/background/functions/update/verifyStorageIntegrity.js":(e,s,t)=>{"use strict";const r=t("./src/localStorage/loadFromLocalStorage.js"),n=t("./src/background/functions/generateDefaultStorage.js"),o=t("./src/partials/storeLog.js");e.exports=e=>r(["keys","extensionID"]).then((s=>!!(s.keys&&s?.keys?.publicKey&&s?.keys?.privateKey&&s?.extensionID)||n(e))).catch((e=>o("error",29,e,"verifyStorageIntegrity")))},"./src/background/functions/wsTabChanged.js":(e,s,t)=>{"use strict";const r=t("./src/background/functions/closeWSChannel.js");e.exports=(e,s,t,n,o)=>!(!s.url||"complete"===!s.status||"loading"===!s.status)&&void(e===t&&(clearTimeout(o),r(n)))},"./src/background/tabs/index.js":(e,s,t)=>{"use strict";s.onTabActivated=t("./src/background/tabs/onTabActivated.js"),s.onTabRemoved=t("./src/background/tabs/onTabRemoved.js"),s.onTabUpdated=t("./src/background/tabs/onTabUpdated.js")},"./src/background/tabs/onTabActivated.js":(e,s,t)=>{"use strict";const r=t("./src/background/functions/checkTabCS.js");e.exports=e=>{let{tabId:s}=e;return r(s)}},"./src/background/tabs/onTabRemoved.js":(e,s,t)=>{"use strict";const{loadFromLocalStorage:r,removeFromLocalStorage:n}=t("./src/localStorage/index.js"),o=t("./src/partials/storeLog.js"),a=t("./src/sdk/index.js");e.exports=async e=>{let s;try{s=await r([`tabData-${e}`,"extensionID"])}catch(t){return o("error",2,t,s[`tabData-${e}`]?.url)}if(s[`tabData-${e}`]&&s[`tabData-${e}`]?.requestID&&await(new a).close2FARequest(s.extensionID,s[`tabData-${e}`].requestID,!1),s[`tabData-${e}`])return n(`tabData-${e}`).then((()=>{s=null})).catch((t=>o("error",2,t,s[`tabData-${e}`]?.url)))}},"./src/background/tabs/onTabUpdated.js":(e,s,t)=>{"use strict";const{loadFromLocalStorage:r,saveToLocalStorage:n}=t("./src/localStorage/index.js"),o=t("./src/partials/storeLog.js"),a=t("./src/sdk/index.js"),i=t("./src/background/functions/checkTabCS.js");e.exports=async(e,s)=>{if(!s)return!1;if(e&&("complete"===s.status||s.favIconUrl||s.isArticle)&&await i(e),!s?.url)return!1;let t;try{t=await r([`tabData-${e}`,"extensionID"])}catch(s){return o("error",3,s,t[`tabData-${e}`]?.url)}return!(t[`tabData-${e}`]?.url!==s.url)&&(t[`tabData-${e}`]&&t[`tabData-${e}`].requestID&&await(new a).close2FARequest(t.extensionID,t[`tabData-${e}`].requestID,!1),t[`tabData-${e}`]?n({[`tabData-${e}`]:{}}).then((()=>{t=null})).catch((s=>o("error",3,s,t[`tabData-${e}`]?.url))):void 0)}},"./src/config.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),n=t("./src/_locales/en/notifications.json"),o={WebSocketTimeout:3,ResendPushTimeout:10,ExtensionVersion:"1.4.5",Texts:{Error:{General:{Title:r.i18n.getMessage("errorGeneralTitle")||n.errorGeneralTitle,Message:r.i18n.getMessage("errorGeneralMessage")||n.errorGeneralMessage},UndefinedError:{Title:r.i18n.getMessage("errorUndefinedErrorTitle")||n.errorUndefinedErrorTitle,Message:r.i18n.getMessage("errorUndefinedErrorMessage")||n.errorUndefinedErrorMessage},Timeout:{Title:r.i18n.getMessage("errorTimeoutTitle")||n.errorTimeoutTitle,Message:r.i18n.getMessage("errorTimeoutMessage")||n.errorTimeoutMessage},PushExpired:e=>({Title:(r.i18n.getMessage("errorPushExpiredTitle")||n.errorPushExpiredTitle).replace("DOMAIN",e),Message:r.i18n.getMessage("errorPushExpiredMessage")||n.errorPushExpiredMessage}),WebSocket:{Title:r.i18n.getMessage("errorWebSocketTitle")||n.errorWebSocketTitle,Message:r.i18n.getMessage("errorWebSocketMessage")||n.errorWebSocketMessage},OnInstallError:{Title:r.i18n.getMessage("errorOnInstallErrorTitle")||n.errorOnInstallErrorTitle,Message:r.i18n.getMessage("errorOnInstallErrorMessage")||n.errorOnInstallErrorMessage},ExtNameRequired:{Title:r.i18n.getMessage("errorExtNameRequiredTitle")||n.errorExtNameRequiredTitle,Message:r.i18n.getMessage("errorExtNameRequiredMessage")||n.errorExtNameRequiredMessage},ExtNameMinLength:{Title:r.i18n.getMessage("errorExtNameMinLengthTitle")||n.errorExtNameMinLengthTitle,Message:r.i18n.getMessage("errorExtNameMinLengthMessage")||n.errorExtNameMinLengthMessage},ExtNameMaxLength:{Title:r.i18n.getMessage("errorExtNameMaxLengthTitle")||n.errorExtNameMaxLengthTitle,Message:r.i18n.getMessage("errorExtNameMaxLengthMessage")||n.errorExtNameMaxLengthMessage},ConfigFirst:{Title:r.i18n.getMessage("errorConfigFirstTitle")||n.errorConfigFirstTitle,Message:r.i18n.getMessage("errorConfigFirstMessage")||n.errorConfigFirstMessage},RemoveDeviceBadData:{Title:r.i18n.getMessage("errorRemoveDeviceBadDataTitle")||n.errorRemoveDeviceBadDataTitle,Message:r.i18n.getMessage("errorRemoveDeviceBadDataMessage")||n.errorRemoveDeviceBadDataMessage},StorageCorrupted:{Title:r.i18n.getMessage("errorStorageCorruptedTitle")||n.errorStorageCorruptedTitle,Message:r.i18n.getMessage("errorStorageCorruptedMessage")||n.errorStorageCorruptedMessage},InactiveTab:{Title:r.i18n.getMessage("errorInactiveTabTitle")||n.errorInactiveTabTitle,Message:r.i18n.getMessage("errorInactiveTabMessage")||n.errorInactiveTabMessage},LackOfTab:{Title:r.i18n.getMessage("errorLackOfTabTitle")||n.errorLackOfTabTitle,Message:r.i18n.getMessage("errorLackOfTabMessage")||n.errorLackOfTabMessage}},Warning:{TooSoon:e=>({Title:r.i18n.getMessage("warningTooSoonTitle")||n.warningTooSoonTitle,Message:(r.i18n.getMessage("warningTooSoonMessage")||n.warningTooSoonMessage).replace("DIFF",10-Math.round(e))}),SelectInput:{Title:r.i18n.getMessage("warningSelectInputTitle")||n.warningSelectInputTitle,Message:r.i18n.getMessage("warningSelectInputMessage")||n.warningSelectInputMessage}},Success:{PushSent:{Title:r.i18n.getMessage("successPushSentTitle")||n.successPushSentTitle,Message:r.i18n.getMessage("successPushSentMessage")||n.successPushSentMessage},ExtNameUpdated:{Title:r.i18n.getMessage("successExtNameUpdatedTitle")||n.successExtNameUpdatedTitle,Message:r.i18n.getMessage("successExtNameUpdatedMessage")||n.successExtNameUpdatedMessage},DeviceDisconnected:{Title:r.i18n.getMessage("successDeviceDisconnectedTitle")||n.successDeviceDisconnectedTitle,Message:r.i18n.getMessage("successDeviceDisconnectedMessage")||n.successDeviceDisconnectedMessage},SafariReset:{Title:r.i18n.getMessage("successSafariResetTitle")||n.successSafariResetTitle,Message:r.i18n.getMessage("successSafariResetMessage")||n.successSafariResetMessage}},Info:{NativeNotifications:{Title:r.i18n.getMessage("infoNativeNotificationsTitle")||n.infoNativeNotificationsTitle,Message:r.i18n.getMessage("infoNativeNotificationsMessage")||n.infoNativeNotificationsMessage},EnabledNativeNotifications:r.i18n.getMessage("infoEnabledNativeNotifications")||n.infoEnabledNativeNotifications,UnsupportedProtocol:{Title:r.i18n.getMessage("infoUnsupportedProtocolTitle")||n.infoUnsupportedProtocolTitle,Message:r.i18n.getMessage("infoUnsupportedProtocolMessage")||n.infoUnsupportedProtocolMessage},BrowserActionWithoutTab:{Title:r.i18n.getMessage("infoBrowserActionWithoutTabTitle")||n.infoBrowserActionWithoutTabTitle,Message:r.i18n.getMessage("infoBrowserActionWithoutTabMessage")||n.infoBrowserActionWithoutTabMessage},Test:{Title:r.i18n.getMessage("infoTestTitle")||n.infoTestTitle,Message:r.i18n.getMessage("infoTestMessage")||n.infoTestMessage}}}};e.exports=o},"./src/content/functions/isInFrame.js":e=>{"use strict";e.exports=()=>window.location!==window.parent.location},"./src/content/functions/notification.js":(e,s,t)=>{"use strict";const r=t("./src/content/functions/isInFrame.js"),{createElement:n,createSVGElement:o,createTextElement:a}=t("./src/partials/DOMElements/index.js"),i=t("./src/images/notification-logo.svg"),c=t("./src/selectors.js");e.exports=e=>{if(r())return!1;let s={container:document.querySelector(c.notification.container),notification:null,firstCol:null,logo:null,secondCol:null,header:null,h3:null,notificationText:null,p:null};s.container||(s.container=n("div","twofas-be-notifications"),window.top.document.body.appendChild(s.container)),s.notification=n("div","twofas-be-notification"),s.firstCol=n("div","twofas-be-col"),s.logo=o(i),s.firstCol.appendChild(s.logo),s.notification.appendChild(s.firstCol),s.secondCol=n("div","twofas-be-col"),s.header=n("div","twofas-be-notification-header"),s.h3=a("h3",e.title),s.header.appendChild(s.h3),s.secondCol.appendChild(s.header),s.notificationText=n("div","twofas-be-notification-text"),s.p=a("p",e.message),s.notificationText.appendChild(s.p),s.secondCol.appendChild(s.notificationText),s.notification.appendChild(s.secondCol),s.container.appendChild(s.notification),setTimeout((()=>s.notification.classList.add("visible")),300),window.addEventListener("beforeunload",(()=>{s.notification.classList.remove("visible"),setTimeout((()=>{s.notification.classList.add("hidden"),s=null}),300)})),e.timeout&&(setTimeout((()=>{s.notification.classList.remove("visible")}),5300),setTimeout((()=>{s.notification.classList.add("hidden"),s=null}),5600))}},"./src/installPage/functions/configurationComplete.js":(e,s,t)=>{"use strict";const r=t("./src/selectors.js");e.exports=()=>{document.querySelector(r.installPage.newDevice).classList.add("hidden"),document.querySelector(r.installPage.configured).classList.remove("hidden"),"undefined"!=typeof window&&window.scrollTo(0,0)}},"./src/localStorage/clearLocalStorage.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js");e.exports=()=>r.storage.local.clear().catch((e=>{throw console.error({err:e}),new Error(e)}))},"./src/localStorage/index.js":(e,s,t)=>{"use strict";s.loadFromLocalStorage=t("./src/localStorage/loadFromLocalStorage.js"),s.saveToLocalStorage=t("./src/localStorage/saveToLocalStorage.js"),s.clearLocalStorage=t("./src/localStorage/clearLocalStorage.js"),s.removeFromLocalStorage=t("./src/localStorage/removeFromLocalStorage.js")},"./src/localStorage/loadFromLocalStorage.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js");e.exports=e=>r.storage.local.get(e).catch((e=>{throw console.error({err:e}),new Error(e)}))},"./src/localStorage/removeFromLocalStorage.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js");e.exports=e=>r.storage.local.remove(e.toString()).then((e=>e)).catch((e=>{throw console.error({err:e}),new Error(e)}))},"./src/localStorage/saveToLocalStorage.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js");e.exports=function(e){let s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return r.storage.local.set(e).then((()=>Object.assign(s,e))).catch((e=>{throw console.error({err:e}),new Error(e)}))}},"./src/notification/functions/index.js":(e,s,t)=>{"use strict";s.sendFrontEndPushAction=t("./src/notification/functions/sendFrontEndPushAction.js"),s.showFrontEndPush=t("./src/notification/functions/showFrontEndPush.js"),s.showNativePush=t("./src/notification/functions/showNativePush.js"),s.showNativePushWithoutTimeout=t("./src/notification/functions/showNativePushWithoutTimeout.js")},"./src/notification/functions/sendFrontEndPushAction.js":(e,s,t)=>{"use strict";const r=t("./src/partials/sendMessageToTab.js");e.exports=(e,s,t)=>r(s,{action:"notification",title:e.Title,message:e.Message,timeout:t})},"./src/notification/functions/showFrontEndPush.js":(e,s,t)=>{"use strict";const r=t("./src/content/functions/notification.js");e.exports=(e,s)=>{const t={title:e.Title,message:e.Message,timeout:s};return r(t)}},"./src/notification/functions/showNativePush.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js");e.exports=(e,s)=>{const t={title:e.Title,message:e.Message,iconUrl:"../images/icons/icon128.png",silent:!s,requireInteraction:!1,type:"basic",priority:s?1:0};return r.notifications.create("",t)}},"./src/notification/functions/showNativePushWithoutTimeout.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js");e.exports=e=>{const s={title:e.Title,message:e.Message,iconUrl:"../images/icons/icon128.png",silent:!1,requireInteraction:!0,type:"basic",priority:2};return r.notifications.create("",s)}},"./src/notification/index.js":(e,s,t)=>{"use strict";const{sendFrontEndPushAction:r,showFrontEndPush:n,showNativePush:o,showNativePushWithoutTimeout:a}=t("./src/notification/functions/index.js"),i=t("./src/localStorage/loadFromLocalStorage.js"),c=t("./src/selectors.js");e.exports=class{static show(e){let s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,t=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];return i(["nativePush"]).then((a=>a.nativePush?o(e,t):s?r(e,s,!0):n(e,!0)))}static showWithoutTimeout(e){let s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return i(["nativePush"]).then((t=>t.nativePush?a(e):s?r(e,s,!1):n(e,!1)))}static clearAll(){const e=document.querySelector(c.notification.container).querySelectorAll(c.notification.notification);if(e)return Array.from(e).forEach((e=>{e.classList.remove("visible"),setTimeout((()=>{e.classList.add("hidden")}),300)}))}}},"./src/partials/DOMElements/createElement.js":e=>{"use strict";e.exports=function(e){let s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";const t=document.createElement(e);return t.className=s,t}},"./src/partials/DOMElements/createImageElement.js":e=>{"use strict";e.exports=(e,s)=>{const t=document.createElement("img");return t.src=e,t.alt=s,t}},"./src/partials/DOMElements/createSVGElement.js":e=>{"use strict";e.exports=e=>{const s=document.createElement("svg");return s.innerHTML=e.trim(),s.firstChild}},"./src/partials/DOMElements/createTextElement.js":e=>{"use strict";e.exports=function(e,s){let t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";const r=document.createElement(e);r.className=t;const n=document.createTextNode(s);return r.appendChild(n),r}},"./src/partials/DOMElements/index.js":(e,s,t)=>{"use strict";s.createElement=t("./src/partials/DOMElements/createElement.js"),s.createImageElement=t("./src/partials/DOMElements/createImageElement.js"),s.createSVGElement=t("./src/partials/DOMElements/createSVGElement.js"),s.createTextElement=t("./src/partials/DOMElements/createTextElement.js")},"./src/partials/sendMessageToTab.js":(e,s,t)=>{"use strict";const r=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),n=t("./src/config.js"),o=t("./src/notification/index.js");e.exports=(e,s)=>r.tabs.sendMessage(e,s).catch((s=>{if(s.toString().includes("Receiving end does not exist"))return o.show(n.Texts.Error.LackOfTab,e)}))},"./src/partials/storeLog.js":(e,s,t)=>{"use strict";const{loadFromLocalStorage:r,saveToLocalStorage:n}=t("./src/localStorage/index.js"),o=t("./src/sdk/index.js"),a=e=>e.replaceAll("http","h**p").replaceAll("://",":**").replaceAll("www","w*w").replaceAll(".","*");e.exports=async function(e){let s,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length?arguments[2]:void 0,c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"",l="Unknown Error",g={logID:t};switch(console.error(t,{errObj:i},c),!0){case i instanceof Event:l="EventError",g.errorInfo={currentTargetURL:i?.currentTarget?.url||"",path:i?.path||[],type:i?.type||""};break;case i instanceof Error:case i instanceof SyntaxError:case i instanceof ReferenceError:case i instanceof TypeError:l=i.name||"Error",g.errorInfo={message:i?.message||"",stack:i?.stack||"",toString:i?.toString()||"",cause:i?.cause||""};break;default:l=i?.message||"Unknown Error",g.errorInfo=i}try{s=await r(["logging","extensionID","extensionVersion","browserInfo"])}catch(e){console.error(e)}if("logging"in s||(s=await n({logging:!1},s)),!s.logging)return!1;if("Firefox"===s?.browserInfo?.browser_name&&"105.0"===s?.browserInfo?.browser_version&&14===t||"Chrome"===s?.browserInfo?.browser_name&&"107"===s?.browserInfo?.browser_version&&14===t||"Chrome"===s?.browserInfo?.browser_name&&"107.0.0.0"===s?.browserInfo?.browser_version&&14===t||g?.errorInfo?.message.includes("FILE_ERROR_NO_SPACE")||407===g?.status)return!1;if(g.errorType=i?.constructor?.name||"",g.extensionVersion=s.extensionVersion,g.browserInfo=s.browserInfo,g.url=a(c),!c.includes("http")&&"undefined"!=typeof window&&window?.location?.href)try{g.frontUrl=a(window?.location?.href)}catch(e){}return(new o).storeLog(s.extensionID,e,l,g).then((()=>{s=null,l=null,g=null}))}},"./src/sdk/index.js":e=>{"use strict";e.exports=class{REST_API_URL="https://api2.2fas.com";onSuccess(e){return 200<=e.status&&400>e.status?e.json():Promise.reject(e)}async onError(e){const s={};return s.status=e.status,s.statusText=e.statusText,s.content=400<=e.status&&500>e.status?await e.json():e,Promise.reject(s)}ignoreError(){return Promise.resolve()}createExtensionInstance(e){return fetch(`${this.REST_API_URL}/browser_extensions`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then(this.onSuccess).catch(this.onError)}updateBrowserExtension(e,s){return fetch(`${this.REST_API_URL}/browser_extensions/${e}`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"PUT",body:JSON.stringify(s)}).then(this.onSuccess).catch(this.onError)}getAllPairedDevices(e){return fetch(`${this.REST_API_URL}/browser_extensions/${e}/devices`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET"}).then(this.onSuccess).catch(this.onError)}removePairedDevice(e,s){return fetch(`${this.REST_API_URL}/browser_extensions/${e}/devices/${s}`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"DELETE"}).then(this.onSuccess).catch(this.onError)}request2FAToken(e,s){return fetch(`${this.REST_API_URL}/browser_extensions/${e}/commands/request_2fa_token`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({domain:s})}).then(this.onSuccess).catch(this.onError)}close2FARequest(e,s){const t={status:!(2<arguments.length&&void 0!==arguments[2])||arguments[2]?"completed":"terminated"};return fetch(`${this.REST_API_URL}/browser_extensions/${e}/2fa_requests/${s}/commands/close_2fa_request`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(t)}).then(this.onSuccess).catch(this.ignoreError)}storeLog(e,s,t,r){return["info","warning","error","debug"].includes(s)?fetch(`${this.REST_API_URL}/browser_extensions/${e}/commands/store_log`,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({level:s,message:t,context:JSON.stringify(r)})}).then(this.onSuccess).catch(this.ignoreError):Promise.reject(new Error("Invalid log level"))}generateQRLink(e){return`twofas_c://${e}`}}},"./src/selectors.js":e=>{"use strict";e.exports={installPage:{configured:".twofas-install-page-configured",newDevice:".twofas-install-page-new-device",welcomeHeader:"h1.twofas-js-welcome-header",container:{app:".twofas-install-page-container-blocks-app",qr:".twofas-install-page-container-blocks-qr",handler:".js-twofas-install-handler"},qr:{timeout:".twofas-qr-container-timeout",regenerate:".js-twofas-regenerate-qr",imgs:"img.twofas-js-qrcode",manual:".twofas-js-qr-manual p"}},optionsPage:{modal:{element:".js-twofas-options-modal",cancel:".js-twofas-options-modal-cancel",confirm:".js-twofas-options-modal-confirm",header:".js-twofas-options-modal-header",text:".js-twofas-options-modal-text"},shortcut:{edit:".js-twofas-shortcut-edit",editText:".js-twofas-shortcut-edit-text",editBox:".js-twofas-shortcut-edit-box",editBoxBtn:".twofas-shortcut-edit-box-btn",editBoxPlus:".twofas-shortcut-edit-box-plus",info:".js-twofas-shortcut-info",tooltip:".js-twofas-shortcut-tooltip",close:".js-twofas-shortcut-close",description:".js-twofas-shortcut-description"},advanced:{header:".js-twofas-advance-header",content:".js-twofas-advance-content"},pin:{gotIt:".js-twofas-pin-info-got-it",prev:".js-twofas-pin-info-prev",next:".js-twofas-pin-info-next",info:".twofas-options-page-pin-info",slider:".js-twofas-pin-info-slider"},hamburger:{element:".js-twofas-options-menu-hamburger",content:".js-twofas-options-menu-content"},menuLink:".js-twofas-menu-link",extVersion:"span.twofas-ext-version",contextMenuInput:"input#twofas-context-menu",logsInput:"input#twofas-logs",testNotification:".js-twofas-send-test-notification",devicesList:".js-twofas-device-list",content:".js-twofas-options-content",toggle:".twofas-toggle",safariReset:".js-twofas-safari-reset"},notification:{container:"div.twofas-be-notifications",notification:"div.twofas-be-notification",visible:"div.twofas-be-notification.visible"},extName:{input:"input.js-twofas-extension-name",updateForm:".js-twofas-extension-name-update",updateBtn:".js-twofas-extension-name-update button",error:".js-twofas-extension-name-error"},preload:".preload"}},"./src/images/notification-logo.svg":e=>{e.exports='<svg fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M23.064 28.05 15.179 33.3a1.873 1.873 0 0 1-2.068.01L5.036 28.04C1.89 25.983 0 22.512 0 18.783V6.015c0-1.67 1.14-3.135 2.768-3.57L10.153.497a15.14 15.14 0 0 1 7.694 0l7.385 1.948A3.699 3.699 0 0 1 28 6.015v12.837c.01 3.69-1.849 7.13-4.936 9.198Z" fill="#E20613"></path><path d="M20.535 11.256H7.465c-1.03 0-1.869-.83-1.869-1.85 0-1.018.84-1.849 1.869-1.849h13.07c1.03 0 1.87.83 1.87 1.85a1.85 1.85 0 0 1-1.87 1.849ZM14 14.955c0-1.019-.84-1.85-1.868-1.85H7.465c-1.03 0-1.869.831-1.869 1.85 0 1.018.84 1.849 1.869 1.849h4.667c1.039 0 1.868-.83 1.868-1.85Zm-4.666 5.548c0-1.019-.84-1.85-1.87-1.85-1.028 0-1.868.831-1.868 1.85 0 1.018.84 1.85 1.869 1.85 1.04 0 1.869-.832 1.869-1.85Z" fill="#fff"></path></svg>'},"./node_modules/webextension-polyfill/dist/browser-polyfill.js":function(e,s){var t,r,n;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=[e],t=function(e){"use strict";if(!globalThis.chrome?.runtime?.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const s="The message port closed before a response was received.",t=e=>{const t={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(t).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,s=void 0){super(s),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const n=e=>e&&"object"==typeof e&&"function"==typeof e.then,o=(s,t)=>(...r)=>{e.runtime.lastError?s.reject(new Error(e.runtime.lastError.message)):t.singleCallbackArg||r.length<=1&&!1!==t.singleCallbackArg?s.resolve(r[0]):s.resolve(r)},a=e=>1==e?"argument":"arguments",i=(e,s)=>function(t,...r){if(r.length<s.minArgs)throw new Error(`Expected at least ${s.minArgs} ${a(s.minArgs)} for ${e}(), got ${r.length}`);if(r.length>s.maxArgs)throw new Error(`Expected at most ${s.maxArgs} ${a(s.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((n,a)=>{if(s.fallbackToNoCallback)try{t[e](...r,o({resolve:n,reject:a},s))}catch(o){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,o),t[e](...r),s.fallbackToNoCallback=!1,s.noCallback=!0,n()}else s.noCallback?(t[e](...r),n()):t[e](...r,o({resolve:n,reject:a},s))}))},c=(e,s,t)=>new Proxy(s,{apply:(s,r,n)=>t.call(r,e,...n)});let l=Function.call.bind(Object.prototype.hasOwnProperty);const g=(e,s={},t={})=>{let r=Object.create(null),n={has:(s,t)=>t in e||t in r,get(n,o,a){if(o in r)return r[o];if(!(o in e))return;let u=e[o];if("function"==typeof u)if("function"==typeof s[o])u=c(e,e[o],s[o]);else if(l(t,o)){let s=i(o,t[o]);u=c(e,e[o],s)}else u=u.bind(e);else if("object"==typeof u&&null!==u&&(l(s,o)||l(t,o)))u=g(u,s[o],t[o]);else{if(!l(t,"*"))return Object.defineProperty(r,o,{configurable:!0,enumerable:!0,get:()=>e[o],set(s){e[o]=s}}),u;u=g(u,s[o],t["*"])}return r[o]=u,u},set:(s,t,n,o)=>(t in r?r[t]=n:e[t]=n,!0),defineProperty:(e,s,t)=>Reflect.defineProperty(r,s,t),deleteProperty:(e,s)=>Reflect.deleteProperty(r,s)},o=Object.create(e);return new Proxy(o,n)},u=e=>({addListener(s,t,...r){s.addListener(e.get(t),...r)},hasListener:(s,t)=>s.hasListener(e.get(t)),removeListener(s,t){s.removeListener(e.get(t))}}),d=new r((e=>"function"!=typeof e?e:function(s){const t=g(s,{},{getContent:{minArgs:0,maxArgs:0}});e(t)})),m=new r((e=>"function"!=typeof e?e:function(s,t,r){let o,a,i=!1,c=new Promise((e=>{o=function(s){i=!0,e(s)}}));try{a=e(s,t,o)}catch(e){a=Promise.reject(e)}const l=!0!==a&&n(a);if(!0!==a&&!l&&!i)return!1;const g=e=>{e.then((e=>{r(e)}),(e=>{let s;s=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:s})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)}))};return g(l?a:c),!0})),f=({reject:t,resolve:r},n)=>{e.runtime.lastError?e.runtime.lastError.message===s?r():t(new Error(e.runtime.lastError.message)):n&&n.__mozWebExtensionPolyfillReject__?t(new Error(n.message)):r(n)},p=(e,s,t,...r)=>{if(r.length<s.minArgs)throw new Error(`Expected at least ${s.minArgs} ${a(s.minArgs)} for ${e}(), got ${r.length}`);if(r.length>s.maxArgs)throw new Error(`Expected at most ${s.maxArgs} ${a(s.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,s)=>{const n=f.bind(null,{resolve:e,reject:s});r.push(n),t.sendMessage(...r)}))},b={devtools:{network:{onRequestFinished:u(d)}},runtime:{onMessage:u(m),onMessageExternal:u(m),sendMessage:p.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:p.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},x={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return t.privacy={network:{"*":x},services:{"*":x},websites:{"*":x}},g(e,b,t)};e.exports=t(chrome)}else e.exports=globalThis.browser},void 0===(n="function"==typeof t?t.apply(s,r):t)||(e.exports=n)},"./src/_locales/en/notifications.json":e=>{"use strict";e.exports=JSON.parse('{"errorGeneralTitle":"Error","errorGeneralMessage":"Please refresh and try again.","errorUndefinedErrorTitle":"Something went wrong","errorUndefinedErrorMessage":"Please refresh and try again.","errorTimeoutTitle":"Timeout","errorTimeoutMessage":"Closed connection due to a time limit. Please click regenerate button to try again.","errorPushExpiredTitle":"Push expired for DOMAIN","errorPushExpiredMessage":"Please try again.","errorWebSocketTitle":"WebSocket Error","errorWebSocketMessage":"Something went wrong with the WebSocket request. Please try again.","errorOnInstallErrorTitle":"Something went wrong","errorOnInstallErrorMessage":"Please restart your browser or reinstall the extension.","errorExtNameRequiredTitle":"Extension name required","errorExtNameRequiredMessage":"Please enter the extension name.","errorExtNameMinLengthTitle":"Extension name is too short","errorExtNameMinLengthMessage":"Please enter the extension name with at least 3 characters.","errorExtNameMaxLengthTitle":"Extension name is too long","errorExtNameMaxLengthMessage":"Please enter the extension name with no more than 32 characters.","errorConfigFirstTitle":"Configuration required","errorConfigFirstMessage":"Please configure 2FAS Extension first.","errorRemoveDeviceBadDataTitle":"Device data error","errorRemoveDeviceBadDataMessage":"Please refresh and try again.","errorStorageCorruptedTitle":"Extension storage is corrupted","errorStorageCorruptedMessage":"We will try to fix it for you. Please wait.","errorInactiveTabTitle":"Inactive tab","errorInactiveTabMessage":"Please refresh this tab to use the 2FAS Browser Extension.","errorLackOfTabTitle":"Your tab has been closed","errorLackOfTabMessage":"The request will be ignored","warningTooSoonTitle":"Wait a moment","warningTooSoonMessage":"Please wait DIFF seconds before sending another request.","warningSelectInputTitle":"Select the text field first","warningSelectInputMessage":"Select the text field for the 2FA token then click the extension icon or use the chosen shortcut.","successPushSentTitle":"Push sent","successPushSentMessage":"Please check your phone and accept your login request.","successExtNameUpdatedTitle":"Success","successExtNameUpdatedMessage":"Extension name updated","successDeviceDisconnectedTitle":"Success","successDeviceDisconnectedMessage":"Device disconnected","successSafariResetTitle":"Success","successSafariResetMessage":"Browser Extension configuration removed","infoNativeNotificationsTitle":"2FAS Notifications","infoNativeNotificationsMessage":"From now on, you\'ll be receiving system notifications instead of 2FAS custom ones. If you\'d like to change this, go to the ","infoEnabledNativeNotifications":"extension\'s settings","infoUnsupportedProtocolTitle":"Info","infoUnsupportedProtocolMessage":"Only HTTP and HTTPS protocols are supported by 2FAS Extension","infoBrowserActionWithoutTabTitle":"Info","infoBrowserActionWithoutTabMessage":"Using outside the browser is not supported by 2FAS Extension","infoTestTitle":"2FAS Notification","infoTestMessage":"Hi! This is just a test"}')}},s={};function t(r){var n=s[r];if(void 0!==n)return n.exports;var o=s[r]={exports:{}};return e[r].call(o.exports,o,o.exports,t),o.exports}(()=>{"use strict";const e=t("./node_modules/webextension-polyfill/dist/browser-polyfill.js"),{onConnect:s,onCommand:r,onContextMenuClick:n,onInstalled:o,getBrowserInfo:a,onMessage:i,onStartup:c,browserAction:l,createContextMenus:g,dummyGetLocalStorage:u}=t("./src/background/functions/index.js"),{onTabRemoved:d,onTabUpdated:m,onTabActivated:f}=t("./src/background/tabs/index.js"),p=a();e.runtime.onInstalled.addListener((e=>o(e,p))),e.runtime.onMessage.addListener(i),e.runtime.onStartup.addListener(c),e.runtime.onConnect.addListener(s),e.action.onClicked.addListener(l),e.commands.onCommand.addListener(r),e.contextMenus.onClicked.addListener(n),e.tabs.onRemoved.addListener(d),e.tabs.onUpdated.addListener(m),e.tabs.onActivated.addListener(f),setInterval((()=>u()),25e3)})()})();